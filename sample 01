import pandas as pd
import os

# Adjust file paths for Windows
input_filepath = r"C:\Downloads\test\your_input_filename.csv"  # <-- Change to your actual file name
output_filepath = r"C:\Downloads\test\output.csv"

# Read your CSV file
df = pd.read_csv(input_filepath, dtype={'Id': str})

# Create normalized name combination so order doesn't matter
def make_normalized_name(row):
    return ' '.join(sorted([row['Fname'], row['Lname']]))

df['normalized_name'] = df.apply(make_normalized_name, axis=1)

# Sort/group by normalized_name and Id
df_sorted = df.sort_values(['normalized_name', 'Id'])

# Drop helper column and save output
df_sorted = df_sorted.drop(columns=['normalized_name'])
df_sorted.to_csv(output_filepath, index=False)

print(f"Output written to: {output_filepath}")
